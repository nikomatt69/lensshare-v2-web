var a="https://mycrumbs.xyz/api/leafwatch/impressions";var i=null,t=new Set,s=()=>{let e=Array.from(t);e.length>0&&i&&(t.clear(),fetch(a,{body:JSON.stringify({ids:e,viewer_id:i}),headers:{"Content-Type":"application/json"},keepalive:!0,method:"POST"}).then(()=>{}).catch(()=>{}))};setInterval(s,5e3);var n=async()=>{await self.clients.claim()};self.addEventListener("message",e=>{e.data&&e.data.type==="PUBLICATION_VISIBLE"&&(t.add(e.data.id),i=e.data.viewerId)});self.addEventListener("activate",e=>e.waitUntil(n()));
