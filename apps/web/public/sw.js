var n="https://mycrumbs.xyz/api/leafwatch/impressions",a=5e3,t=null,e=new Set,o=()=>{let i=Array.from(e);i.length>0&&t&&(e.clear(),fetch(n,{body:JSON.stringify({ids:i,viewer_id:t}),headers:{"Content-Type":"application/json"},keepalive:!0,method:"POST"}).then(()=>{}).catch(()=>{}))},l=async()=>{await self.clients.claim()};self.addEventListener("message",i=>{i.data&&i.data.type==="PUBLICATION_VISIBLE"&&(e.add(i.data.id),t=i.data.viewerId)});self.addEventListener("push",i=>{i.waitUntil(self.registration.showNotification("MyCrumbs",{body:"New Notification",icon:"/icons/icon-192x192.png"}))});self.addEventListener("push",i=>{let s=i.data?.json();self.registration.showNotification(s.title,{body:s.message,icon:"/icons/icon-192x192.png"})});self.addEventListener("activate",i=>i.waitUntil(l()));setInterval(o,a);
