var s="https://mycrumbs.xyz/api/leafwatch/impressions";var e=null,t=new Set,n=()=>{let i=Array.from(t);i.length>0&&e&&(t.clear(),fetch(s,{body:JSON.stringify({ids:i,viewer_id:e}),headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},keepalive:!0,method:"POST"}).then(()=>{}).catch(()=>{}))};setInterval(n,5e3);var a=async()=>{await self.clients.claim()};self.addEventListener("message",i=>{i.data&&i.data.type==="PUBLICATION_VISIBLE"&&(t.add(i.data.id),e=i.data.viewerId)});self.addEventListener("push",i=>{i.waitUntil(self.registration.showNotification("MyCrumbs",{body:"New Notification",icon:"public/icon.png"}))});self.addEventListener("activate",i=>i.waitUntil(a()));
